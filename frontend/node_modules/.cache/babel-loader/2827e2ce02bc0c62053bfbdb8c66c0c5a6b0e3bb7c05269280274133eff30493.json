{"ast":null,"code":"// funzione helper per effettuare richieste autenticata con il token jwt\nexport async function apiFetch(url, options = {}) {\n  // recupero il token dal localstorage\n  const token = localStorage.getItem('token');\n  // aggiungo l'header Authorization se il token è presente\n  const headers = {\n    ...options.headers,\n    ...(token ? {\n      Authorization: `Bearer ${token}`\n    } : {})\n  };\n  const response = await fetch(url, {\n    ...options,\n    headers\n  });\n  const contentType = response.headers.get(\"content-type\");\n  if (!response.ok) {\n    // provo a leggere json, altrimenti testo\n    let errorBody;\n    try {\n      errorBody = contentType && contentType.includes(\"application/json\") ? await response.json() : await response.text();\n    } catch {\n      errorBody = await response.text();\n    }\n    throw new Error(`errore http! status: ${response.status}, body: ${JSON.stringify(errorBody)}`);\n  }\n  if (contentType && contentType.includes(\"application/json\")) {\n    return response.json();\n  } else {\n    const text = await response.text();\n    throw new Error(`risposta non-json, body: ${text}`);\n  }\n}","map":{"version":3,"names":["apiFetch","url","options","token","localStorage","getItem","headers","Authorization","response","fetch","contentType","get","ok","errorBody","includes","json","text","Error","status","JSON","stringify"],"sources":["C:/Users/AlessioLongo/OneDrive - ITS Angelo Rizzoli/Documenti/Workspace/pokemonweb/frontend/src/services/api.js"],"sourcesContent":["// funzione helper per effettuare richieste autenticata con il token jwt\r\nexport async function apiFetch(url, options = {}) {\r\n  // recupero il token dal localstorage\r\n  const token = localStorage.getItem('token');\r\n  // aggiungo l'header Authorization se il token è presente\r\n  const headers = {\r\n    ...options.headers,\r\n    ...(token ? { Authorization: `Bearer ${token}` } : {}),\r\n  };\r\n  const response = await fetch(url, { ...options, headers });\r\n  const contentType = response.headers.get(\"content-type\");\r\n  if (!response.ok) {\r\n    // provo a leggere json, altrimenti testo\r\n    let errorBody;\r\n    try {\r\n      errorBody = contentType && contentType.includes(\"application/json\")\r\n        ? await response.json()\r\n        : await response.text();\r\n    } catch {\r\n      errorBody = await response.text();\r\n    }\r\n    throw new Error(\r\n      `errore http! status: ${response.status}, body: ${JSON.stringify(errorBody)}`\r\n    );\r\n  }\r\n  if (contentType && contentType.includes(\"application/json\")) {\r\n    return response.json();\r\n  } else {\r\n    const text = await response.text();\r\n    throw new Error(`risposta non-json, body: ${text}`);\r\n  }\r\n}"],"mappings":"AAAA;AACA,OAAO,eAAeA,QAAQA,CAACC,GAAG,EAAEC,OAAO,GAAG,CAAC,CAAC,EAAE;EAChD;EACA,MAAMC,KAAK,GAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC;EAC3C;EACA,MAAMC,OAAO,GAAG;IACd,GAAGJ,OAAO,CAACI,OAAO;IAClB,IAAIH,KAAK,GAAG;MAAEI,aAAa,EAAE,UAAUJ,KAAK;IAAG,CAAC,GAAG,CAAC,CAAC;EACvD,CAAC;EACD,MAAMK,QAAQ,GAAG,MAAMC,KAAK,CAACR,GAAG,EAAE;IAAE,GAAGC,OAAO;IAAEI;EAAQ,CAAC,CAAC;EAC1D,MAAMI,WAAW,GAAGF,QAAQ,CAACF,OAAO,CAACK,GAAG,CAAC,cAAc,CAAC;EACxD,IAAI,CAACH,QAAQ,CAACI,EAAE,EAAE;IAChB;IACA,IAAIC,SAAS;IACb,IAAI;MACFA,SAAS,GAAGH,WAAW,IAAIA,WAAW,CAACI,QAAQ,CAAC,kBAAkB,CAAC,GAC/D,MAAMN,QAAQ,CAACO,IAAI,CAAC,CAAC,GACrB,MAAMP,QAAQ,CAACQ,IAAI,CAAC,CAAC;IAC3B,CAAC,CAAC,MAAM;MACNH,SAAS,GAAG,MAAML,QAAQ,CAACQ,IAAI,CAAC,CAAC;IACnC;IACA,MAAM,IAAIC,KAAK,CACb,wBAAwBT,QAAQ,CAACU,MAAM,WAAWC,IAAI,CAACC,SAAS,CAACP,SAAS,CAAC,EAC7E,CAAC;EACH;EACA,IAAIH,WAAW,IAAIA,WAAW,CAACI,QAAQ,CAAC,kBAAkB,CAAC,EAAE;IAC3D,OAAON,QAAQ,CAACO,IAAI,CAAC,CAAC;EACxB,CAAC,MAAM;IACL,MAAMC,IAAI,GAAG,MAAMR,QAAQ,CAACQ,IAAI,CAAC,CAAC;IAClC,MAAM,IAAIC,KAAK,CAAC,4BAA4BD,IAAI,EAAE,CAAC;EACrD;AACF","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}